# Лабораторная работа 1 python -- калькулятор М3

## Структура проекта

 <pre>
    .
    ├── laba-1-python                          # Кодовая база моей лабораторной работы
    │   ├── src/                               # Исходный код
    │   ├── tests/                             # Unit тесты
    │   ├── uv.lock                            # зависимости моего проекта
    │   ├── report.pdf                         # Отчет
    │   ├── .gitignore                         # git ignore файл
    │   ├──.pre-commit-config.yaml             # Средства автоматизации проверки кодстайла
    │   ├── README.md                          # Описание моего проекта, с описанием файлов и с титульником о том,
                                               # что и какая задача
</pre>

## Структура папки src -- исходный код калькулятора

<pre>
    .
    ├── src                                    
    │   ├── main.py                            # Файл с точкой входа main()
    │   ├── calculator.py                      # Функция calculator()
    │   ├── functions.py                       # Дополнительная функция calculate_brackets()
    │   ├── error.py                           # Класс для ошибок
    │   ├── __init__.py
</pre>

## Структура папки tests -- unit тесты для программы

<pre>
    .
    ├── tests
    │   ├── tests_base                         # Файл с unit тестами 
    │   ├── __init__.py
</pre>

## Принцип работы:
Запуск приложения происходит через файл main.py и функцию main()

Внутри файла:
- Импорт функции calculator()
- Ввод выражения пользователем
- Вывод ответа через точку входа и функцию main()

Внутри файла calculator.py:
- Реализация функции calculator(expression), где expression -- пользовательский ввод
- Проверка ввода с помощью условий: на каждое условие пояснение в виде ошибки класса ошибок
- Токенизация в список tokens: с помощью методов .strip(), .replace(), .split(), обработка двойных операторов (//, **)
- Удаление незначащих скобок циклом while
- Реализация стека с помощью списка stack и цикла while, в котором tokens[i] -- итерируемый токен, i --- индекс итерации
- Проверка и добавление числа в стек методами .isdigit() и .count()
- Использование функции calculate_brackets из файла functions.py для подсчёта выражений в скобках
- Обработка унарного плюса ($) и минуса (~) с использованием двух предыдущих пунктов
- Обработка операторов: ошибка при неизвестном операнде, недостатке опреаторов, при любом возможном делении на ноль
- Сохранение результата функции как единственного элемента списка stack и проверка на единственность этого элемента

Внутри файла functions.py:
- Импорт функции calculator()
- Функция calculate_brackets(tokens, i), где tokens -- весь массив токенов, i -- индекс начала выражения внутри строки, используется в самой функции и в файле calculator.py. Функция вычисляет выражение внутри скобки, используя рекурсивный спуск к функции calculator() -- возвращает список из 2 элементов: найденное значение и индекс конца выражения внутри скобок

Внутри файла error -- класс ошибок

Внутри файла test_base -- тесты для проверки

## Допущения:
Допускается ввод пользователем с любым количеством пробелов между операндами и операциями. При исподьзовании операций //, % над типом данных float (числа с точкой) выражение считается как в python. Любое допущенное деление на 0, неизвестный операнд или оператор, пустой ввод, незакрытые скобки или некорректная расстановка скобок, отсутствие числа или выражения после унарного знака, недостаток операторов или операндов выдают ошибку

Допускаются следующие операции:
- "+" -- сложение
- "$" -- унарный плюс
- "-" -- вычитание
- "~" -- унарный минус
- "**" -- возведение в степень
- "*" -- умножение
- "/" -- деление
- "//" -- целочисленное деление
- "%" -- взятие остатка от деления
- (expression) -- выражение в скобках

Операнды -- любые целые числа или числа с точкой



В папке [src](./src) лежат файлы с реализацией задачи заданной в лабораторной работе. Обязательным файлом является файл
[main.py](./src/main.py) в котором описана точка входа в приложение - функция **main**. Требования к коду:
- Переменные, функции и модули именуются по [**snake_case**](https://realpython.com/ref/glossary/snake-case/)
- Константы должны быть вынесены в файл **constants.py** и именовановаться с помощию символов в верхнем регистре
- Классы должны именоваться в [**PascalCase**](https://habr.com/ru/articles/724556/)
- Имена сущностей должны быть осмысленные и содержательные
- Все отступы должны быть консистентны: 1 TAB = 4 spaces
- Весь функционал должен быть описан в функциях и в классах. Не допускается писать весь в глобальном скоупе или в одной функции
- К каждой функции должны быть описаны  [**docstring**](https://peps.python.org/pep-0257/) и аннотации к аргументам и выходным параметрам функций.

В качестве референса проще cходу соблюдать [**PEP8**](https://peps.python.org/pep-0008/) и использовать IDE c готовой поддержкой:
например PyCharm или VSCode c настроенными плагинами.
В ходе попыток запушить код в репозиторий ваш код будет проходить проверку статическим анализатором [**mypy**](https://mypy-lang.org/)
а также с встроенным в [**ruff**](https://astral.sh/ruff) на предмет нарушения код стайла. При работе с кодовой базой
всю работу необходимо выполнять в [виртуальном окружении](https://docs.python.org/3/tutorial/venv.html)


В папке [tests](./tests) лежат [unit тесты](https://tproger.ru/articles/testiruem-na-python-unittest-i-pytest-instrukcija-dlja-nachinajushhih) для проверки функциональности программы или ее частей.
Рекомендуется использовать pytest. Также название тестов должно быть осмысленно и содержать определение проверямой части.
Базовые соглашения pytest можно посмотреть [здесь](https://www.qabash.com/pytest-default-naming-conventions-guide/).
Рекомендуется проверять не только успешные кейсы, но и краевые условия и кейсы в которых была допущена ошибка (неудачные кейсы).

В качестве пакетного менджера в данном шаблоне/репозитории используется [uv](https://github.com/astral-sh/uv).
Можно использовать и [стандартные виртальные окружения](https://docs.python.org/3/library/venv.html). В таком случае необходимо добавить в репозиторий `requirements.txt`.
Это достигается командой
```shell
pip freeze > requirements.txt
```
Также разрешается использовать [`poetry`](https://python-poetry.org/)
## Как работать с репозиторием и шаблонами
1. Необходимо создать репозиторий из этого шаблона. Посмотреть можно [здесь](https://docs.github.com/ru/repositories/creating-and-managing-repositories/creating-a-repository-from-a-template)
2. Склонировать или спуллить его к себе на машину командами `git pull` или `git clone`
3. Создать виртуальное окружение:

    a. Для uv прописать команду `uv venv`. Затем прописать `.venv/bin/activate` в терминале

    b. Для обычного python `python -m venv <имя директории где будет храниться папка .venv>`. Затем прописать `.venv/bin/activate` в терминале
4. Установить [`pre-commit`](https://pre-commit.com/). Для этого достаточно ввести команду `pip install pre-commit`
5. Выполнить команду `pre-commit install`
6. При запушивании в репозиторий необходимо правильно составлять сообщения коммита. Правила можно прочитать [здесь](https://github.com/RomuloOliveira/commit-messages-guide/blob/master/README_ru-RU.md)
7. **Внимательно** читайте то, что пишется при попытке коммита, если исправили ошибки нужно заново добавить отредактированные файлы в гит и попробовать коммитнуть
